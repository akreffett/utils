#MAEC Malware Subject Class

#Copyright (c) 2012, The MITRE Corporation
#All rights reserved.

#Compatible with MAEC v3.0
#Last updated 12/28/2012

import maec_package_1_0 as package_binding

class malware_subject:
    def __init__(self, generator, malware_instance_object = None, malware_subject_attributes_dict = None):
        self.generator = generator
        #Create the MAEC Subject object
        self.subject = package_binding.MalwareSubjectType(id=self.generator.generate_sub_id())
        #Set the Malware Instance Object Attributes (a CybOX object) if they are not none
        if malware_instance_object is not None:
            self.subject.set_Malware_Instance_Object_Attributes(malware_instance_object)
        self.malware_subject_attributes_dict = malware_subject_attributes_dict
        #Instantiate the lists
        self.analyses = package_binding.AnalysisListType()
        self.findings_bundles = package_binding.FindingsBundleListType()

    #Public methods
    #Set the Malware_Instance_Object_Attributes with a CybOX object
    def set_malware_instance_object_attributes(self, malware_instance_object):
        self.subject.set_Malware_Instance_Object_Attributes(malware_instance_object)

    #Add an Analysis to the Analyses
    def add_analysis(self, analysis):
        self.analyses.add_Analysis(analysis)

    #Add a MAEC Bundle to the Findings Bundles
    def add_findings_bundle(self, findings_bundle):
        self.findings_bundles.add_Bundle(findings_bundle)

    #Build the Malware Subject from the input dictionary
    def build_from_dictionary(self):
        for key, value in self.malware_subject_attributes_dict.items():
            pass

    #Get the Malware Subject
    def get(self):
        self.__build__()
        return self.subject
    
    #Private methods

    #Build the Subject, adding any list or other items
    def __build__(self):
        if self.analyses.hasContent_():
            self.subject.set_Analyses(self.analyses)
        if self.findings_bundles.hasContent_():
            self.subject.set_Findings_Bundles(self.findings_bundles)

